//
// Issue15.cs
//
// Author:
//       igor <igorgue@protonmail.com>
//
// Copyright (c) 2022 HODL Wallet
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.
using System.Diagnostics;
using System.IO;
using System.Reflection;

using NBitcoin;
using Xunit;

using Liviano.Exceptions;
using Liviano.Interfaces;
using Liviano.Models;
using Liviano.Storages;

namespace Liviano.Tests.Regression
{
    /// <summary>
    /// Regression #15 https://github.com/hodlwallet/liviano/issues/15
    /// 
    /// Network = TestNet
    /// Mnemonic = abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon about
    /// HdPath = m / 84'/1'/0'
    /// Total Txs = 133
    /// Adress types = Segwit
    /// 
    /// Errors on transactions of the abandon...about mnemonic run --doctor to fin the txs
    /// 
    /// All data coming from http://tapi.qbit.ninja/tx/{txId}
    /// </summary>
    public class Issue15
    {
        // This is the wallet on file for the tests
        const string WALLET_ID = "62d50d77-a430-4177-a3ec-d548db3261a7";
        readonly IWallet wallet;

        public Issue15()
        {
            wallet = Load(WALLET_ID, Network.TestNet);
        }

        [Fact]
        public void Tx_9fca06b2a6469d401f33ef86d29ea4cdd832c35e6384f5df663e9fd4a95df3ac()
        {
            // A tx that was working already
            RunTest(
                hex: "01000000000101b5561450458314097d23e48ce2ef6eefe2581ed226a03ee27f843929d8a090440000000000fdffffff0240420f0000000000160014d0c4a3ef09e997b6e99e397e518fe3e41a118ca1d8bb6f01000000001600141eb17d4dcc40dcc15091597e5367438ef3e6eec1024730440220391911c8bc0e59ac10d339a0e299f9477857a9e86fc2beb9c68a40ed6bc325c202203571b8e169f53e8b949786164b5fb80dc3e42ddad78d1b9f0777695a3ea23efc0121024ea4015948ecb68ff3ff4b5092ecc77188f2f63766a5c45db7f1822c88cb1b1606391300",
                height: 1259783,
                headerHex: "00000020b2af82b123da13087ef087ee541413c87513e48c589739784049f960000000000ab56ceb5c2884c461d3c349cc212ee23c357939f4d7c43e65f8105a8331d8e8fd6c645affff001d2cbead41"
            );
        }

        [Fact]
        public void Tx_3e610a6f94ad1b0f0799e196678cd580696628fc3aef7b73f26818cda6bb5ac4()
        {
            RunTest(
                hex: "020000000001014f56343b252f32a922481a7f40c24e29c9f305b1aa9230f32c8752f9e7961cec0100000000fdffffff019395680000000000160014e0dd6c1d3b99a5fc7a9da4b648ce4a7ac7f01031024730440220752e94aaccc3aaafe0eae36f2f7e62148f589adc38f8d320e780ca96d19baa3502202b35f883b1baec68acd6e0ed6e063f25865c99ecd0991ac469e153b5ab5b9f78012103b858ef5d6e074c4738b37feabb74db46d80403e3e560694890a9a5e0bc22693c05022100",
                height: 2163206,
                headerHex: "00000020b8cb584d5883ee386fa27549a3518e8ae64980145ba257159ab9c876000000001649e2c98d8460ecce2d983c8354b598747234314450c3f41b4ea6734ab7b6429fd01362ffff001d046a500c"
            );
        }

        [Fact]
        public void Tx_28269d0841e3c0824d04659780e1cb1dbe8e806619eec1bfcba80e3fb1c726c2()
        {
            RunTest(
                hex: "010000000001019a204a7c27c2f6ff8c41e959f8aab27f9d0f8dde89a54ea607e910ed415ee0960000000000ffffffff01d09b000000000000160014269a7224acf8a31f7be59efe7db8d9ba3a204ff602483045022100a838a115f83ab0ed3c98d3c351944c6805600cd0d2e1d8c7f0807383a88dfa5f02203c220db8df48637b359d1043a334521a299c508d383ca972569e70fb11eba1420121039191d34ca380fac499a072e5762217bf6fe6b7ea157faaf771c78c89ef444c4300000000",
                height: 2138098,
                headerHex: "04e0ff2f8866e4a740d838f84865a91ddcc061519fe10c7c842b4eed0500000000000000f53f48e06efc021d6b07dbc20db998816b9774d5ba3f4d4a67458fe3d0ef0e2fd3baf561cbcd001a10ffee58"
            );
        }

        [Fact]
        public void Tx_5fa3cffef5beec913e700b1315b1940d079410898cf9ce672dbb65b138fd275b()
        {
            RunTest(
                hex: "010000000001013a9440ecf7dc4709394c296129334744ec05f4534ba55a0b3cab28f5edc9a5b40000000000ffffffff01c074000000000000160014269a7224acf8a31f7be59efe7db8d9ba3a204ff60247304402202f796dee11b6b86c79e8b85ba541706039d7f208f52d31b7c9d35f56081e662802207021f009d6d95382d3d3b3108d43c1f823cf0579b48e9c49d0dec6dc556c6c23012103610008903596be72b0be7ed0dc9c2165fa6c82677ad77c706641a771a9bea2fd00000000",
                height: 1933360,
                headerHex: "00000020701b602f78e36d534a40fcb957d876c7f677b9f847d0420f300000000000000026e6446261a8fab13a8c2986171a1b490d224d564815553ee5f501c9b2b50994ec971b60c0f13419010d591d"
            );
        }

        [Fact]
        public void Tx_ce4c8f0a2aa63256bd144aaebf30837a9232d57dc20cad9f0da5b2bb7090d699()
        {
            RunTest(
                hex: "02000000000101567c97480b1baf730833020dcf37e5cd27f5411ce01146ecc7e833bdc1cc52810100000000fdffffff021027000000000000160014a8ba3f31f06770ccb04ebad873b5563c1adef9e2b0eb3100000000001600140b7223b24f0a931e87a212f1ab690f73cb0f8cc4024730440220248ebd5b00cf7529b6d1fa80db53cd6224ae34e169c326940919a416e056727902201327c4798652853e186e8692ac6c00c572f3d175c8fc0dd74565219bfbcb8fc5012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c319d2921e00",
                height: 2003668,
                headerHex: "0000e0202d63e0591a85b072836e8de214682fb9c75191436deb329ad7000000000000009d50777c310d0c1119dbb2959064512aacfc6c6ce41bceb12140931c6f3d9729bbe3be60ffff001a12038b12"
            );
        }

        [Fact]
        public void Tx_23ee48735d6db2534983475d79bf6066450445be9db850f780357350ab09eb32()
        {
            RunTest(
                hex: "02000000000101d33a014a322d0ec45e58a719d466287421a1be187d47bc63ae0ef4de7b32f5b40000000000fdffffff01a22600000000000016001444ce632aa730cc2c96a6ef9f4a0960afcfbb2d090247304402207d575cc180680305711cc0805dd8b4790169c59b6a68765e01819676d93a7e70022024b8dcf94dd1dcd7bc7c36535874fd031b783d97d82b8a44afdbf5c818b3c77e012102b396686039259ba12198413122c86f5375932ca0be7e052e48107654eb8b097e2c852000",
                height: 2131245,
                headerHex: "00000020b875618bf87e2d707c7c2d7ab2ec8c2e17a78085b6166ff8cd00000000000000be6188fcca9156cbdab9b062a5e08b2cade9397c5ab376a2a95d7e178011a41389ecb961ffff001d11dd819b"
            );
        }

        [Fact]
        public void Tx_786113d96eb52d5921d919e51c1d0054d3028a7ba8c589d1eca13fc0df73d512()
        {
            RunTest(
                hex: "010000000001019012cfd1a3d9a73be613fe457b3528931941a56a28e5e74b233556fe3551a6100000000000ffffffff013006000000000000160014269a7224acf8a31f7be59efe7db8d9ba3a204ff60247304402205a40788dcfcd2043bd3cda7021e5fd6ac3fea9734bdc3bbec5bf3a803f782f2302202b21e72f15e1da7049054435e423ccbd223d481d8793d8d21904c936136a84150121038d963a72ae8c5c2ca5a63f7fe39b2227216ed74bc4ac6b841dc6886817fb89c000000000",
                height: 1970112,
                headerHex: "0000002030acaf5f2928b222f951c0d69aabd1912b9c1e32576182020600000000000000257982657368f8fe845f5af59fa958bf56faad6b34061ad29a36c40f6934fb241e316b60f7f21f19dd559cab"
            );
        }

        [Fact]
        public void Tx_5b0ef462c8713ca40c6b03cb7dc8d60affae86edc0653f8b135fe667478c4141()
        {
            RunTest(
                hex: "02000000000101bac25a67aa9cd4c039b0ffa445de5fdef7fb1e41eacfd103bf955b654d2012260100000000fdffffff01a22600000000000016001428efdda30c4c9250178279ab05a2cce52187cc43024730440220110dbb97192535fb2e631c7a9fabe9660cc2bcb7606deebd6714cd11244db443022053552741130135f9465e8d2331943d73556cb32d28f5dac0872e6f43578023050121030eb9e31da15b2e9d95138e1926e7ee90ef9c3312a7a95d74f169e34f1c0177833a852000",
                height: 2131259,
                headerHex: "04e0ff3fe82930780dd8e51edc4cde7c9b171f3e1e621bf2f6aada0766000000000000000508cc5d3df2e6dd5072559fc07633e46175393e3835f05843ea8d07ad615d40a105ba61ffff001a507ba382"
            );
        }

        [Fact]
        public void Tx_3866aee5e9b4719066af763f95e67b75f3e84023aec218700899c6af967f6544()
        {
            RunTest(
                hex: "01000000000103902e0f0c8733be1085be545170e01ed2c2743266b46f49946141b05f3d196c400000000000ffffffff8e9337ceb2c92e7d3fc8a0db197506b65201553744102c8a64d8268bdf43ffc90000000000ffffffff207deb3faf9d2e172a44baab90a8d29c98a81674e420e49f0ec4658dc12d68ce0100000000ffffffff01c6d3010000000000160014269a7224acf8a31f7be59efe7db8d9ba3a204ff6024830450221009fd99c00169157cd4855f5aa833cbaabc9529991c9837c1278eca54faaef351402202a5064149510f2d154ca98fdbc321da5a8697a2f7b1c76af5bf06d91537ba0fe012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190247304402200d22e586a8b805e5edb55cf0b3424a527c4b56ab030896452c4d2d79dbac430b02207e52e983c3b24845fbb5d6d5a10ada6f3756ac348b52f0152c32af51346ff093012103733372e169f02c8270306bb6116ace9548e91b5a7be609c7023cdd5b796b695202483045022100c7f114a8fbe46de475b67c915dee36e2367f76897943f534bffd13bcd3b3035102202df63d168444e864d25bf66ae3e68e787915640d78a943ff4b791cd6159e6560012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31900000000",
                height: 2136742,
                headerHex: "000000204869cebe62ccf14ce7b2dbf4ebb619342a69e98fa0b9fac3fd7603bb00000000fb24fd0c21e45a8829372b184609513bef7da950b83825906afeea6a62a0be0d620dea61ffff001d5b05aec7"
            );
        }

        [Fact]
        public void Tx_b950b1f85c9b79890baecde0f47bc82d5d39fd3e2a4a0dc08826247bf1006d51()
        {
            RunTest(
                hex: "0100000000010199d69070bbb2a50d9fad0cc27dd532927a8330bfae4a14bd5632a62a0a8f4cce0100000000ffffffff0140eb310000000000160014269a7224acf8a31f7be59efe7db8d9ba3a204ff602483045022100a80120e442d5167787966e565b90008ef20f52a6f8ecfee2c05f069149f2682602205eda8abb0d4fde558709cd878e2eb07c417c42abe3ddccb9a093c101ddae240c0121023d923f5259aadeef9221abb1ee7610a17cf07868c996d45329e8a4fa0a97276700000000",
                height: 2003834,
                headerHex: "04000020f04230738f51665416163f8993ee6d57f8c4b0043ca96302a50000000000000010dedc8f648088d08e0925606f51ffca7cfc89d003030963ad248e6bb968bd365a39bf60ffff001ae296db48"
            );
        }

        [Fact]
        public void Tx_77777451889f5653b24405c49be4d13bc6d53957adef53313e0311589f3c5ce0()
        {
            RunTest(
                hex: "01000000000105ef417bf785cfff97d8d069f848c03a68efcb9db195b953f84f6a42e5a0855c720000000000ffffffff760e23e56679c775be488839481f2ccd209c9ae5525258e731350b75297153940000000000ffffffff2d2cf0e45d22105f5e6979e262dde9c64dfb2ed2c3ac36c4e2c6d662a7dac60b0000000000fffffffffce4e190ba50b888a3b6056cbfb062550da026945f970ff38cd194b9a09d49840100000000ffffffff7b42981d779563def3cdd4c2fed0be7b1ccb326db1a5cf95365f3e543b70b5bf0000000000ffffffff01341d24080000000017a9142edacc916b46d13b0e8d1e40afb71e037f45c20b870247304402205de75c0e58b322e625af70111b47420a8d50c517763c0600197af384625950ad02201dc3a2e44182161efc0cd8250ccc3c59047d025de96e12b4797c1f40416994c6012103f37f9607be4661510885f4f960954dadfc0af91ea722fe2935ca39c1e54c29480247304402203f5633fbf3a04a705bdd2aee1bac379a20d1f9b5a4898827dba351477cd23ff602204f924d145330218afd6c4ee94978c6e5b98000ca0d56dbcdcfe435faf57b94ab012102e6c60079372951c3024a033ecf6584579ebf2f7927ae99c42633e805596f2935024730440220218d29897c990bbef30770da78fb0b8acf63b1758c551bb3fdeb1be6a8f2de9e02203d7077e3ffd62c444af5dc1fc3150af299b598014564e600e86802956644b0550121033adaeff018387bf52875cfd0a82ff29680f042e15010cb5b716b2976736698360247304402202b8c279f75d217f073fc474232802da80a1f2ff62c8500348ebdcfd916422247022079b64a487aa72e115be219d19689e3437f31c5ae963d3018ff96d21f80b63c470121028304f73220f0382dc0bebc4d36d7faa08e3daa707c6804baa2a3d703bb1a1d8102473044022019cea14d090094cefa0340528812bf7abcc4093b2db1c516ac0a4bdac3fb580f022039393785877d5f63fd641194924c229adf5250c9bb0c5f86e0979770461f494101210347122fe54cf188f1f75cf8e1d4c1c4c234128c5a1a7ce6d4948a15732232ccef00000000",
                height: 1936870,
                headerHex: "00000020ad2d839049da954ba9a8b3f5e10df15f318c3a19e989614ecc00000000000000f05a45ab53b61c68bc73553d3d999ae28cf80ba3e212f0a8cff1d0a96f86ff29352c015cffff001d4ccd6e73"
            );
        }

        [Fact]
        public void Tx_8858c6fbc6816a8893f2e8efa23d5f1096d4f7cc674038777b5d673b82c9861b()
        {
            RunTest(
                hex: "010000000001067e3d5b1e8671566d7380d150ca46a26249d1ec453aa15d04b0f551a742ca7b1e0000000000ffffffffad5b7e35a593743bc208d0a70d890f0ab4d9199e60a728461449eb6819e9d4900000000000ffffffffb99f8be5b386f9d152c3bc1643a99a57affd0937ed045d70edf5a6bc6725faf30100000000ffffffff7251e04b7552e39b295c241129ceb01115fa9ad356e71a7c66fe259c64ed76130100000000ffffffff46670002f797dea130b879e4b793bbbbcbffbfdec76278246365bbf0ac3fabe60000000000ffffffff953a5f6befec096d1922ad0bc384402771ba57ca71620435bc98fca1f1e5d5140000000000ffffffff01d8dd040000000000160014269a7224acf8a31f7be59efe7db8d9ba3a204ff602483045022100b7175c01d3aee393526fb974999a94e04cb80e92886f2532e6566ffab7da878602203ae734623121aa342fcadf3123947c03637c820c4e14d2286baec85e27bb0af601210247de233ef9d19cc20eb9e0968c5b397056fb38f2e9f644e9c7005a9e7dfa7a8a02483045022100b162f1fc481c22a466d6311cf29ce8247db381ffe730ddc300488350a4e3bff602203e990fd138d46de437025aaed024f43afcf60b00737a7d46a3d31f87721a139b01210292ddba71871dd9515aac5f0f71e8acbc5db71fd5d816bdd62dd23448b608bbbb02473044022018372d96e68363bddf42d90d065759578bf92781895149167f3171174b5d3ac202206e43dd4057b43776f341533e4da33ea009f8b7e40978c0640a2527583680239f0121035d49eccd54d0099e43676277c7a6d4625d611da88a5df49bf9517a7791a777a502483045022100f3f5f77d1b41ab92abb1879047726656808892da55c9ff5deb443c804904cfbf0220670fc77a636fac86c8f84ed9739844da532afa681e027a2eb2ffea916c20d449012103eeed205a69022fed4a62a02457f3699b19c06bf74bf801acc6d9ae84bc16a9e102483045022100f43f06154b38fd5ca882e1041d9c5ccf76b2b441774948019293120e472b382602206aabd15de474e05b5912a2dd59aa91acf3d589d8fee4188bd14771c03d61a1cf012102105d0e55b9a741b873a9c0bd52ecac6f85f58de93e19d48c8c0ea33f54806b5f02473044022053e1c4c198d1c1beb9695510fd43731a89de062a555999ae10af15250c78b433022058c1adb763e73f8760800e6e1edd2fb7c0ae9e931ac1bc2edf250aeec6e053bc01210370cfa6506ef43a4a2d1c8738dab63e54750435078a312760d104657dbdad962c00000000",
                height: 1446051,
                headerHex: "00e00020ce3d928ce44c2295e01f323f6464620f8180a5979d9358d40c00000000000000a76e4aa83e1d437ad830d5fec8163e2761f837860e445138847709b106e42bc4641a306067061a19410c8e0d"
            );
        }

        [Fact]
        public void Tx_9b073f92ee6009a160cf21cec9929df4186e53b2b0f0cd919ab99a18e4f9a88e()
        {
            RunTest(
                hex: "010000000001013452e45ec55ee6273eeae8b987cdfd451ca33e810ef1defcc9c04867da6626470100000000fdffffff0165f4660000000000160014aa4e900422a74b2a8d3065f8be6c840e35f533a20248304502210088736d7386a9a0dfebac6cf152753f35fae57bd4d84626fd56e973e689d67a6202205f8ba158053fdf40b5c3570eb7f7e0e53332d9ed5d88b82bed47adcc52f4bbbb012103eeed205a69022fed4a62a02457f3699b19c06bf74bf801acc6d9ae84bc16a9e10b3b1300",
                height: 1260300,
                headerHex: "000000206ee041042792c5707b83776d22650037b6b7f8c95da5558a1001000000000000a6029c01a1d75ed26cc911e6783a06ba9c96cfadbdb59075f809a840975d57a6aae3685af7f4071abe9b5f43"
            );
        }

        [Fact]
        public void Tx_fbe1447e16ca92f65eea9414a2531df9ca9e3b5765904424b3abab78165533ff()
        {
            RunTest(
                hex: "01000000000102a8d3dfce68c0394ba723eafc1a50922d1761b5c857864eba3a20e0c81d172db90000000000fffffffffd5ecaf090c2176419778624c99ccfbc463f982050fdefa608223f5bfdd3ddff0100000000ffffffff018c4d000000000000160014269a7224acf8a31f7be59efe7db8d9ba3a204ff6024730440220696536788aff73d14b83ed20ffa610ef0f7a1ed6d6eebebe430ff2434d2e18f70220712abb95196fbc685e89c5e000401944c5ba179d4ec8fb27a393f926ff1d16b3012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31902483045022100c4544fb07670b4859fb7b21accccd9e72d0b273cf080beea7b46b4432c3561a7022014c3dc436712007b748dc82988a4a1f4e07e274c9aa950e7c2e7d71c9ebc902e012103f6760536385d2132a57ecb332354610323b057ea29925734cc825354c00306c000000000",
                height: 1891234,
                headerHex: "000000200507b6a06333e9998ab8a4d7ef92aa85165d3431373b72ce2b90fd0d00000000d208085beb2c980b5dff5e80216653632f825a4b46d95777d54934e60877e3bbc014ab5ff9bc001aa9f15527"
            );
        }

        [Fact]
        public void Tx_6d7668dabd3eb618c43fb5e2ce92c3f20ff8d72875d48230cf0d23fa4ff53def()
        {
            RunTest(
                hex: "01000000000101e0ed0a8563293a2df459ec1e10e7da8a8cdc215dd10ed2ff929e5435e36f4da20100000000ffffffff01f63c000000000000160014269a7224acf8a31f7be59efe7db8d9ba3a204ff602483045022100899f8ddb657bc0719c8523ad25a3141e6bfae76ee87f47ebc42a4def96c3675902201163837b39390ea85b04a93b2020b435cf570f485615a824f19d152abc39fbdc01210256956f66a9911ca8627dc4289f4d20c9682c1930b8bcd0fd0e2ca51f5528d8d400000000",
                height: 2097162,
                headerHex: "00008020b15abf4b3a17f57bf7f12c00af5577d96cc9c56c793dafcd0200000000000000bd23524fed4909dc216c6a9602677b5a2ae06c166c05b329db404956b449719133bf56614aa1451909112c13"
            );
        }

        [Fact]
        public void Tx_26301cf85c0ac24a3364cf82eb0b353209941769a280b46f9816649f51d699d6()
        {
            RunTest(
                hex: "010000000001052b911420fafe759978e36bb5a6ee95149eaf2f4066d7e1c4d4bdf89a9eaa4155010000006b483045022100e6b5feedb071aae3d947be8967a984e3ffe56f22c42da2289ebef7952393536f02207a691e7cd63b132e72d7db02ffc3c8ef1d91e2540890a41eb6edd3242bb01d97012102a7451395735369f2ecdfc829c0f774e88ef1303dfe5b2f04dbaab30a535dfdd6ffffffff2b911420fafe759978e36bb5a6ee95149eaf2f4066d7e1c4d4bdf89a9eaa4155000000001716001438971f73930f6c141d977ac4fd4a727c854935b3ffffffffa1bc208676fed75a412c9528bf3b6c8d5d4afebd8b43764d2448c820a47c587f0100000000ffffffff6778be073f9d1d0d500953105c84f55d73a2c6bb6f3f810525ade5cf8ec58b0f000000001716001423cf48b75446a0e4169b858d4561735f06c6cec3fffffffff7a8affcceff1de4d1b7a8d73d655f3b66a4cf9ba4c08f68621995228568a7f6010000006a4730440220538be4d040768f1821138a5826d6701bb9fbc7c1107d79a858269c8b017174080220732085bf9c2d6f38f2b5c0d813a18e09e75f82701dddf3f1571b9fd9733ad1b6012102a7451395735369f2ecdfc829c0f774e88ef1303dfe5b2f04dbaab30a535dfdd6ffffffff01743703000000000017a91416870bea4ecfd0cc1b301140c3ea3469ceb8780587000247304402201e4d18ca94d9b54a7f04b0c555cfac7a87aa3c8ee56be77029b279b2667c124b02206eb3c2b36c5a6541b177c07ac000d3c7e71b7c52aaa5f372ba27c07141d8472b012103a1af804ac108a8a51782198c2d034b28bf90c8803f5a53f76276fa69a4eae77f02483045022100ea86f05db2dba876739eb1acae25d8489b6754028bc8fd983d3ae497391e32e502200876da1ca500163ffdd7ff6631500116de3dc86f3a588fa939dfe7efdb4560ec012102b67ccd43f1442a51faccb5fdca442485ae011b01d2b9cff298ceb215982501fb0247304402200747e940e0249f1eaf6ff54d4bfbd03ce548d51fe50d68e724979c74c724f2e1022035c1b84e517e151951bb8338da7bf074861df574dd670a99592a3f62c8e13906012103245491c3953e773c35be0e1f5f8c3f97c012b1d28c1dbbcd4d814ea611a960e50000000000",
                height: 1454957,
                headerHex: "0000ff3fc7b653a0b2161f11282afb74b375169516ad1be91689c5c129000000000000007c787719de3fc4c9ddffc04661e3fb4e835a9dfa78722a962591ae0f0de5bcec1279545c0335011a0ff846e8"
            );
        }

        [Fact]
        public void Tx_8289b0d8563b4887aca76884073c1f7d10b4b8629a8ed2e802b793a038c34110()
        {
            RunTest(
                hex: "010000000001038068289576d2b15ca63f89e6eb10cdb022bcb88861672af313f7e9a4d013365d0000000000ffffffffef8833daf9eb799f20dd7d19c89f8aceccf66d4bcef66ce842ef179da88635eb0000000000ffffffff5a4f397e64c24aa83f20a09467c1839bc2c216884b902756bb28bf6b339c59fc0100000000ffffffff015855050000000000160014269a7224acf8a31f7be59efe7db8d9ba3a204ff602483045022100a5b61425746c541edbeed3e234a6e73326b271de54b9ce5756eaa2b10406439402201734e8051aefca53ee3f8a0d9deedb6875d530202f62f76da1417a97f8763757012103610008903596be72b0be7ed0dc9c2165fa6c82677ad77c706641a771a9bea2fd02483045022100b3d7ea878f1a746d3810ab1b3b7544008f85a9e5b834aca40f84b5bf83def143022072c05c5348bd05af263fef1206b0b9ef76c74e14d1d4905fec906f173f386f22012103bb5db212192d5b428c5db726aba21426d0a63b7a453b0104f2398326bca43fc202473044022068f6bcc9ac351ec8c5f936d1ed90882561f33c9e4f470e14a192e26f50bd7d82022023fff51f5e4c46e559dad252616e3cefbaaecc85fee82d8059672bb48d06cb1301210292ddba71871dd9515aac5f0f71e8acbc5db71fd5d816bdd62dd23448b608bbbb00000000",
                height: 2035442,
                headerHex: "0000a0204a811dd36cf1b222f24dbcb116e31408569326d7979ec2272c00000000000000941909dab77cbf644647fcbd268517c64e123c5958c2cafe60d6e7de5afa04b67a3ff560c0ff3f195d16181a"
            );
        }

        [Fact]
        public void Tx_ae94a6933e5e002999b7e654dfdc068c02d854f28fa4e43d318cf45b92d9a64a()
        {
            RunTest(
                hex: "01000000000119b89c2e257845d600b5d2fd6bfcb0f12b1c493fc5938c7e83544d9dc5e344191d0100000000ffffffffb66de396fe34ab9eb59ac3938ac9ff2d6be6025cd8fa70dec626d554b1f07c1d0100000000ffffffff6738674dc8e8fad06baa3d940984342f2d872124dfb8d53f3531cc62fb9fef0d0100000000ffffffff5d5a06bb22160f2c4ef07478ad636eee58530d4014b877e9bbb8c0f680c0cbb40100000000ffffffffcf548f0d99f90d8e419adec9d8174cf8ee20883e8425edf72144d639ed5a4dd70100000000ffffffff1f788651c393c587beacec7ce3a557ff0b4040a0dad176582e1abf8fa24b7b970000000000ffffffff2c16e0cc813b7a23d8289237a90f665a8660729fdf3ccfd0e9cc0daf4df9dc480000000000ffffffff19017391baf279265797f285a38b379b631b3976b1435102da0820ab97a343c30100000000ffffffff014d025b84af2da8b58e0d31efbdda48f1f4b29e492085fdc6e44175dd620c8e0100000000ffffffff636b98e91f7e8647990ca25a2f8a8675bf4f79b3b4d10a47c9173ff8e87f4dfe0100000000fffffffff003c948b1feec76f41df0a6d6703756b0bb1e2b18de6ed189d221e25908aa7c0100000000ffffffff9be063603e8b6220fb5b72ec61f1c287f3b2a34e6caba7d8013d2845f064f5730100000000ffffffff8c54ddd3266c1a87969fecffcc4e47f96ab51f330364822ba0568fa80473c9eb0100000000ffffffff01c0789d88271c88d1bf5a13b64c174999ec13017b0f4d958891856a7197f5840100000000ffffffffa404e6e8fc88bfe690acf00a97de60b7a67dc24d588bd7e642fec6fbb6349d810100000000ffffffff67547f888ccfc7a3ca81230b70957cbc573aa5eba4f9c612e1568d5b1a0c32150100000000ffffffff287eeff857a16d3620e704fc8237c5283e57c2c4721c63fab44e5ac5ecaf24a20100000000ffffffffc0fcf04b2ac9d175dabb9562b8399a36ddce275e7c9aa763733386c73706e1210100000000ffffffff452728cb74d6681d9aa668b8d634c7d7970c7123df62f54d715e323e0f7ceca60100000000ffffffffb83c390e5aded74e952ae9f19db869f155a54f1e3362bf8941f731b365f215230100000000ffffffff691477f2be5ad316e385d2c520835f1315e27c86330bef442aa6448c50da67510100000000ffffffffe39d1debc2d48c788a49b434ffe6911a92ea631229847b64c033617c77c4c7290100000000ffffffff57b40b603ffb5b8e2f729d77f7fcae9492ae4707284cf4f0b141edc6607742dd0100000000ffffffff2b514a2983ac4132f4cf2217c7ab7a3d3b535d66533e4eea1f70804e511e7068000000001716001438971f73930f6c141d977ac4fd4a727c854935b3ffffffffc15507cfea0b18bc829482cfd83b3f16a2d9474f8c0c747e2a9fa81d090013f10100000000ffffffff014e185a0000000000160014269a7224acf8a31f7be59efe7db8d9ba3a204ff602483045022100cec5c2e8d0174a2da821519afe8e9c5201be9060080a68bed2a2623d96e49f0b02207a3d72711146f235e20cdb83037cb9ee4cd51d91c311507b74cd97c11afff84a012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190248304502210086ba158c53f890632543d6692ec9f96e5dc128a8a531a83f933e0a89132aa1c5022020e8e7f1a289d0aa326156cc9dd275a298526174bd6e2b401893344fac55f5a2012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31902483045022100fcd9ffe26aa86f8ef2efe780517bbc8763d6e9212e77f83abc05c4efd2b2ee1b02204c7a336380f49f8e0d4441d52c80013342e28b4f23e5ede05eff0ab93b40c4ee012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190248304502210081c34d9d274b474b04cc4156fbe1f7c79345ae394a0bc993a623c41d613115a00220058c0bed5c6b4e82b90780c3fdca5adb01d283c8d70a2a5c7227f3537ffe4b1e012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31902483045022100ff8f9a05e137636e271e9691fd2fc6600962840d7b357642f4ee1ed0e0cef453022066ce5909b1163f9cb041b40319efa227e36bfeb9eb38256fd9984325ebb0b229012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31902473044022005468b53f89182b0e5bac56280e40f1fb87bdbb3127a62ea5911a0598b050fc702201222099db987b71f60826cc5d9674d72150885d89560ed0bda44a4933e8e7b8f012103f6a0a0a23ce3e86e8b858c521865cd7448cec8cc429db80c617c7fe496560c2902483045022100b8352e0d50cc42f0363d55297e16d86244d85d36305623dcbe3ab46e56f2f49a0220407b6199ff8de76d70edaf6f82cc95c662beff982817b37c3536c16c85682a4d01210295b77f540db326a3347abaa0f8d1e62a9af261629f5e4bbfd682089e6c13aa7902483045022100b202dc1e276a4280fdfc1972428bfd0e0bca1ed63d5dd53976dac4893d6025c20220258840f902e33b15c37cff137fca235283431b83610b23bd89cc88e05dc22ad4012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190247304402202f30cff7923c1a9ebc8832334d4f85d604931efd3e6199e1506b697d8ebc03d0022049e8d4eec33f7a4949242d3bebe1ae37505e83a89ab9ffc652a2ada34aaa278a012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190247304402206584b5f4712a13453c5d9da3cf15584461a8fcd7b3be18c3e1958871dd467924022027a92be955d045d7e1c70f45ffea651bd758e00acda8beeca370a1c65443a8c8012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31902473044022034d3264651861721359133a3268788eb4c19012c617c987cdf99ea9d5fb20476022040919b1a43701ec58e21dc2bde8fd5bdfd20e150d8c2a8605bb72bd1d0a4565f012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c319024730440220413e5990cbc7f69fc0edd0ee512a0fb39abfebb1b5570a75c7ba0db08c67dbde0220439e626704de6564633d4d4f4b1e7acc5e9a50ce87d0dfc3034bd86cb6bb88a0012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31902483045022100e2ecf315e5354b6eadcbea8568f14c0055e7c9baeb33b59947ab0354bd3069e00220291d25b7d793f8f4c730b75f63c3f4ad86ffce7e48e310476c69bbde8633d691012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190247304402206c8e111b4cb2bf443137a2b5334c25c0256802bafadb23ff995c76fccfb220a8022049562af18fc6df0b01c043d12666b7417fd07cd59e9ca44f369e9327929d44fd012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31902483045022100b1bcd6af2be77c96dfe7dd2b6c31f4e95f49daa184bb11c73685778af81cf9fd022064fcfa00999cacedb0bfed72fdff5124216fa501692a6d0a350164e6ecaa90b901210397bd8426ad20aed66a9762a56b5bd6435e2c06cdb31166acd3a57ddbc8c7219102473044022016dad35c2c26513a4a804412d10ba5401a32a2e43fbae3274d58f526abdacb58022055ad732adfb65b387d19b6002797a4427d85c626d21227c1a43543cbf2130f32012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c319024830450221009221d2853c49e1bc30eac8c1e043d6233ba051497ca31478a2102d9c0809ce71022049f676050929a558e786fefd37a154657f726a1ceb68688e79f91f50287e1788012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31902483045022100ea76f59bfcd10bca587e045841211d1db27a6ceceb1c99ad2bc7a0a27a97c1e002202e6bf1dc63444ead0867a6fd0b1542a9a0500c01a77340dcc70af67670829eb6012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c319024830450221008c0e127a808e35122b8fc0467f5a0ac784acba1a2defc4775bfa357fc3f95bbf0220771ace6589e6242ec8dbb8decc69d7c7e8e139689e1141e4d202891ff9945ea9012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c319024730440220744920189e40807bd1a683fc8cb68e5a4fde275b355dc2a2197bcab1e0a6bbb9022043933a474df49c5159184de04f6314bf1cd722e2907459ffbbe8ea5e5ded4123012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190247304402207d8911202b84abe27333db959b2841911e7f3e8d2698e38de76f6fbb769aa6390220198c1b9820c867a3a305e8263989848e5f15dc204697a411dc8d724199635e83012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190247304402201f0dbd384a96a2764ff6c1490f5acb8259a09d7744f0041f8931279076a2e7270220566709ebd77d749e1d5b5acc49efc45b2b9b45fbe0fbb26f34df2fd80d2e1ae1012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190247304402205e0537330bc5f05d1593b3c1aa2d8a3b3482dd00e1522f76721092173987980a0220033d2acf9e73e4cc7f372cd479eab06d5ced7fe404607f86daff8da49f132641012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c319024830450221008f270d989d94d3f04d42fab88214e63b85851fea09ba60260b38d571e730cf87022074d7190ccffdff6cdda174b27878ac444838a6bb5cc76c39e8b1497d62687440012103a1af804ac108a8a51782198c2d034b28bf90c8803f5a53f76276fa69a4eae77f02473044022012e49b0b617f6909e26775aa9dad5ca07507844b56530e1df74f400f84f56e8e0220472e8a5f3dc47bec07bdc2b2e57a4053c8b01c22eff3b666fac474d6db52fb09012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31900000000",
                height: 2190429,
                headerHex: "04200020556a5bea59478fb36ecb4a46662cab3335d6bca5b1ae04386d0000000000000073f68f9ee03670d870eb771aaadcae528f0dca1d7cb23a956ff3cc18e67671a3a9963562ffff001d4a561c6a"
            );
        }

        [Fact]
        public void Tx_cbb1f39da6015584b6c3df0c7325faf91eb67ddf263e73da8b8fe2f90935ffde()
        {
            RunTest(
                hex: "01000000000105f0b7b7ad837b4d3535bea79a2fa355262df910873b7a51afa1e4279c6b6f6e6f0000000017160014eee02beeb4a8f15bbe4926130c086bd47afe8dbcffffffff6840a9cf2e9de75e6572cad70cedc1892e008734dcc6a5fb758fed85de6967420000000000ffffffff6840a9cf2e9de75e6572cad70cedc1892e008734dcc6a5fb758fed85de6967420100000000ffffffff027a726f8aa4e81a45241099a9820e6cb7d8920a686701ad98000721101fa0aa0100000017160014d815dddcf8cf1b820419dcb1206a2a78cfa60320fffffffff0b7b7ad837b4d3535bea79a2fa355262df910873b7a51afa1e4279c6b6f6e6f0100000017160014cdf4c64549699034ebfa35d3b2fdf3e5490d66d6ffffffff013fef3500000000001600147f8a2b8c1e927075c7956b8aabccec1d863428de02483045022100c804cffe0af5c20ee829556874cac18984d40f4346ed50dfcd9356758f3e183f022042945049aef76297277d7ed38b60a600d5f533e5ac6180bcadcccca88abd6862012103cfbca92ae924a3bd87529956cb4f372a45daeafdb443e12a781881759e6f48ce024730440220382113d995779de68c0e575734cacb638b216ed5e13b57ca16aeeb26e8f64bd6022031c8e4094c00b0f32ebae14dd8ed93d7fce2979bd7dd9244d1a7aff2987fd55e012103eeed205a69022fed4a62a02457f3699b19c06bf74bf801acc6d9ae84bc16a9e10248304502210097ff97407c25f64ca4ca7dd72e781ea8cecebca92f8ba275d73f3c507ba03f4b02201fa11f39b39c2575b7465c01e0c2cdee93782caddae22adbd6bd33d2506a39770121035d49eccd54d0099e43676277c7a6d4625d611da88a5df49bf9517a7791a777a502483045022100a4672501c664a16640fc24690f5cd167d3f63c9df321499048da4221ed12d669022036ef4025817ab2d3a2b6931ea6d6297461879412a02bf514bf678393e37834d301210293137bc1a9b7993a1d2a462188efc45d965d135f53746b6b146a3cec9905322602483045022100b51013f6454edc1ada742e821784ac16d2216736f181b2be3a9968d308962cf20220055cbcb3a2d2f98739c4206121c8bc7fd7b4c51257ee1642f92fcc043fe38c02012102fb7e211e769b48013a0f21c0f8030235ae92f396ded25c86d3acd4e699fbf17a00000000",
                height: 1746866,
                headerHex: "00000020dcdbfb47846d516e98ebcc1818d995a01c4bb3ac17347bc0cf41f35700000000b5b160ce427d9e9d1a0a6c231eed9c4241afbe26404e06fbb7a138c82bdd70684fd5d15effff001db29ece31"
            );
        }

        [Fact]
        public void Tx_f58fe0973b9981727aa143e4b362e12fd50c80d89200bd4acc6399eaeff8ddb3()
        {
            RunTest(
                hex: "01000000000101cb7573d4beefc5cc835c8e8b89e58e40b6062db3c3f78171904320a2296d1d100000000000ffffffff01d0410f0000000000160014269a7224acf8a31f7be59efe7db8d9ba3a204ff60247304402207afc0d576d90412e952d8f0fb5856b09533411b4fd6d3395164968375531b77d02204f677e2c63b5f1163acfcca18aaac92fc1ad291b3cd5510ec5b2672c1a508c5e012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31900000000",
                height: 1774957,
                headerHex: "00000020659538b32892cbb16e83e461aa1fa20d01249e9463b4e1883c0000000000000034a1f1d2be0c7a4d3ec12d2ad0f62ae35839546bcb825c3de4c8c20fe1ceee7b5c14fe5effff001d0bdab089"
            );
        }

        [Fact]
        public void Tx_e2e53d42709caf997f76778081b7c63e321c98fa1111532f3db87194ae8ac1d4()
        {
            RunTest(
                hex: "020000000001033237f023326c80a1efc27459d1da4b3f41159db4a1aacec08f3bec524c6b594a0000000000fdffffff8058ad045a01b433cfd3a765d8d897f6c37cec5148e9b4bcfc03ad70d7686c800100000000fdffffffcf8a1f830d61f3e3379d5546a3398421fb5843dbdaf2741f9659fbf75a5002ee0100000000fdffffff017eae02000000000022002019866592c8e2e4690045e22545e5bcb5ffa06fff591d35bdbea748d78fb036420247304402207f1548f6e367e83403751254fa5ed2c25139f49c428a99b811b1bd51ad81fc7e02201b930e759c942981132cfee53921796370bb43877f4ef147f6fdb4e08b6da550012102b1571f70c0d52ba8d491afa0e9891f83cbc558c74d12509307edd188abf800f40247304402206511d90b6128e4dcca243aee0cf32b9c46a7a2e6d95812a7f67cb8efaa97907c02205629869d12722df7b38e565b33397acb41b50bea6aaae10607cfd6684fdc9404012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c319024730440220313cd43d9de3e1cbdffb83b33a4aee91dd06ed039bab0dd4f194553f9d3fe5c10220712da62663eaf1fa281ea1276c74fc4f32ab00da06bb7ec0ad6fcc1cda19b60c012103eeed205a69022fed4a62a02457f3699b19c06bf74bf801acc6d9ae84bc16a9e19a1a1e00",
                height: 1972891,
                headerHex: "0000c02021e147c8ca867ae647af97e0e3f668e31740dd16c29880ee1500000000000000b61c439be58cbff37fadad80748612a24e5cbaaf68ee00e6ef9d88e75c46d493b8348860f4411f19ba2ada51"
            );
        }

        [Fact]
        public void Tx_f022b123e9d8d473e752ff86c9bdf70f81e14e3d388534aa66bd087bb0e627ae()
        {
            RunTest(
                hex: "020000000001018ee411bfd8be1655641ea56b990e7c2f47679aa6503a53a996cb1c49e86fda0a0100000000fdffffff012e860100000000001976a914344a0f48ca150ec2b903817660b9b68b13a6702688ac02473044022026fd2dbfaf8d7564c2d94ed2dc5eaa7fb9020911f632ecfc065748701351b8ef022015c42001b5b97412abc9e98f725b6f4e565d76eb191c63240c72679fc547682f012103eeed205a69022fed4a62a02457f3699b19c06bf74bf801acc6d9ae84bc16a9e100000000",
                height: 2034934,
                headerHex: "00006020582c179e7bc55c2b926e38a1066aeea5c16135841192dbec0b00000000000000ee6a4a13c590e1f8e6671d0d80174efcc6b677e298aa5de3c06a8158d2fb1a5f71bff260c0ff3f196f3627cd"
            );
        }

        [Fact]
        public void Tx_943c8d3fb1e1cdd88f6f609134348df376e5871fd32fb3343c0d69cddf2e97f4()
        {
            RunTest(
                hex: "0100000000010466942b4eb367a693dea61fdae4a829e270641f3a870b5f0e312bf359a77d10a5010000001716001438971f73930f6c141d977ac4fd4a727c854935b3fffffffff1b007a73371ee4caa483dcdf7548db3b979e5cea720522acb8ce232b33bd41f0000000000fffffffff1b007a73371ee4caa483dcdf7548db3b979e5cea720522acb8ce232b33bd41f0100000000ffffffff80ba78f736ece2a6f89fcc5e528a6724fcc9640b74d70c4c403505ef5215d6780100000000ffffffff01cfea010000000000160014269a7224acf8a31f7be59efe7db8d9ba3a204ff602483045022100eb1a6700c3bb02bd53de16b4b765c22f6a434ca7b6863d268110f2378d5b1d75022077bd4a1d15a9ad31423ab77b3299a1d5f0f4ecfa50b42d6c963914c1ecc02b03012103a1af804ac108a8a51782198c2d034b28bf90c8803f5a53f76276fa69a4eae77f02483045022100907a91e7bdfa5def1ed3d1bb61095b6173253c7133093fe1206d48a5db32539f02206058cc895ee98e40a6d9ab677643c84096fff4ed10b698cf94eb1a9866f1b0c0012103eeed205a69022fed4a62a02457f3699b19c06bf74bf801acc6d9ae84bc16a9e1024830450221008c399f60ba185ec3d9869fdc7b77050b2607dd8429dd0ab5649b61bed9f07e940220619cba2c86c7f5da6cce8807da94d0de4f3f0dc63ddfd0d16aae947b16225d8d012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31902483045022100c939cb1cdab9cfdd2b121829743482fbf54d4cb1a1347aab6a4e026c8bf50455022056ad19d0ce4647ec8f94a8bcaebf0d9682e450a85dc517700bd2103d7646027f012103eeed205a69022fed4a62a02457f3699b19c06bf74bf801acc6d9ae84bc16a9e100000000",
                height: 2095020,
                headerHex: "00000020b40fc5314dc6a6191024672bb72d7facdd12a365813bfbedeb26ac6b000000000cc0faac64d0d905fac2ea74ea0ce04954c3539349c6812fa64fa6f0cb5559884da44661ffff001d9b0d9070"
            );
        }

        [Fact]
        public void Tx_a4b70b4409d1c76bf0fef7c5e684ee0e54d3aa4b2afbea7e62fb57300413f8dc()
        {
            RunTest(
                hex: "020000000001028ba58914d3dfd4cb09c1177eaa835b24158f5c48c8ee8524d6806373effec4430000000000fdffffff0f76b583e53f2fed0307645e07141ccfa834f40f1b1e5cdc0ac7fcde8fdc969d0000000000fdffffff012e9f02000000000016001426fa3f9541a7c8081c43e9ed5fad14fff2118513024730440220139fefd6d2850c0b0da03b199adc40deadc0d79f80d5b4c08290cd08e23d873002203e737c391cbfa0646c1c7a7e5f087a7dee17a9d9e0630e7bcbdd51ae8b58d98f012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31902473044022053709928fd3fcd4883cc9c72ec8a29003609af3462e56ced4bdd3f7e95466c6a022048844daabab615b4d6ab3e6e57dc7ea08abdc5c0a61f98f22a7b007aa1901516012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c319d31f1e00",
                height: 1974228,
                headerHex: "00000020af8df5feefb4c23d368fcd55fbbe2691c92ef7b1fa92674596ae82be00000000f1d3dae48ca6b9b20cf020d2badc01eaa86a294c7437db2b1043e79e5f049d555e249060ffff001da3dfef16"
            );
        }

        [Fact]
        public void Tx_240f8ef8e931a4582e74864e1e1aa1eabc0041876337943dde83b0ca9f168f96()
        {
            RunTest(
                hex: "020000000001024c9637ccb08ea698d43225964a8b06af962570c14af9a6195a6c4eec0986354d0000000000fdffffff635434229d951e42b228701d5650a11f92b27ea9ebca1ae0656395d9def8049b0000000000fdffffff01060b0000000000001600140c7cdb22e93ac478db93fc17c6e1f5a0f6286f0d0247304402200d628a8a86e8caaf882df9da5f58d68c1f3c56c1ef3612544b0e19cb001a0158022055280294c75b577482dd902640015aaa0df482be6474d45acc2e8e2b5d3aee67012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c319024730440220690e8b86f68abda1724250346801c87442fbee16911e1c859eed10d7524f8fc6022007ee4b1e9b420251977426617343de83504e984440520111ab92f1ac2937c080012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31930201e00",
                height: 1974321,
                headerHex: "04e0ff3738fbb5730daa17f0dbb46a8c494a40b03a8a04aa11fef99c22d72fae0000000088fbf7d9d5d221d1961ca46b842b824a2492497070d25dfa8f0700ac2dd2a2032e1b91600afd2219b0d29cbc"
            );
        }

        [Fact]
        public void Tx_81f6c715b13b864aaa27c243e61b1b79203d96c4c6960b34b205eb4e153150fd()
        {
            RunTest(
                hex: "02000000000101d2fb7d10163af88f83836f5a454cb5ef9353458a15854ea92867f02b50f274c10000000000fdffffff010a1e0000000000001600141634f30e9568cd6a08ccd7aa2703e85862f9a558024730440220237ea601fa8fd9b77c82682d2a07d1c037847910dee6ec15766a7a88adabe72e0220626584c09915dd67c41df9afd427fcf40ab40a1a13d3653430ade287275b4fa6012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3193a201e00",
                height: 1974331,
                headerHex: "00e0ff2f9fff9cca0e76ebe4a9ee645f558717dbff227047c401c9f491b478b800000000e505881610e1e3e0836b00b3afe8ee32410f1efb82ef3b33dd88efb856cc4af7713691600afd2219f7270a25"
            );
        }

        [Fact]
        public void Tx_7129cc62c3a76b6fc45513d80e4c8fa991cdd682d5c03d8100a447c8a4f97be9()
        {
            RunTest(
                hex: "02000000000101f00e1bae61fbf417b3b317fb3b5dcda001a96e4c9f1cba0132490f26beca81670000000000fdffffff01de23000000000000160014467d3f4392941a8c8c21616cd6e0cd05aa0e2e610247304402200500b012bebbeba73994a2d165f9c18cb5c01f52495f642372fcd4473310ba0a02206355482549b84616f8490947ae83653921ab7b3bd65ddaaca7297b0d30d2e8fb012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31900000000",
                height: 2035310,
                headerHex: "00008020ce3b872292b3a58366e6d160bc91c72a3287563179eb75373100000000000000e78731c8fa9f4b4508d04975db2d56be0ec007381b0a5ebf91965805b5d561ec4654f460c0ff3f19889946e4"
            );
        }

        [Fact]
        public void Tx_116af2717e9a2959f4e947b58408d8ed32ee6d8762932879589588d6d2e067fa()
        {
            RunTest(
                hex: "020000000001015de8a00eed6f722b9d0de72044225981e910902b8fae50edbc79cbf052a5d2d30000000000fdffffff014303000000000000160014489bf5ba829c47c9a93f744452d32064dff14ac502483045022100da311b47c24a6523a5f1edb31b5a3f8c2a73abda6c44f58598c67c05fa9bb65802203c41dd932e3588b7f0a1507a620f31644cd18747de32951211027e36758e99c1012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31904022100",
                height: 2163205,
                headerHex: "00000020989195cb098b7df31ea318f47af1129269573923df75a367604060ab00000000aa7e414409ef0ebebbf4ad5f40e1e6de14ac2771055617feef612f4e5b5ce67ccbcb1362ffff001dc527c740"
            );
        }

        [Fact]
        public void Tx_287e1643e61a9ea4a2046b4a09164041b80570e7213068398043268d266ab63e()
        {
            RunTest(
                hex: "0200000000010c7f61455b7f1492b6d4caee162a0aebc6d6033d02e578febe9c93fa9879f440300100000000fdffffff44759a521aedfb6885ee1d3c49ccb59a18a3bd144cb8484a5ce937fbdb329d4a0100000000fdffffffb8d34d68fdce407080b487bf9710a6e41195cd8de396fa263e0da039db1712540100000000fdffffff219323e91658da99f665d70c285bcf4ce6b17414a5ed31cd1fa4035c39292f540100000000fdffffff6f9c2b5e40a101451c65f1b0329d5054e5ae0b187a713a716cc489016228875a0100000000fdffffffa2f4015341c3a35c3d5313be953581752262f23800260fd8b435b49771e2ff970100000000fdffffff8f3b54beddc4be71c0775b875c5fb8b1bef965504db8cb741ccd1d07ffa046980100000000fdffffffde8a0ab310055e306d04870dd4835bcd748eebd328eec4f54f2275e4fab9b3af0100000000fdffffff8800fa5f9b3fbf3b831673d48c168e958ca804199cd4e86592142eb7738e4cc00100000000fdffffff980bcea85e3de09c1ddae32cecec72b39657ba86d961e1aca526e6bbcdd55dc40100000000fdffffff5b99a773f3f00b2d893696f48c8c07dcef2f74b2037333139da9aed3122f19d60100000000fdffffff0072ebbd0e8bd2cc5b27ee9e6eba98148f08a3bba039624a12171915c39af7ff0100000000fdffffff01b55b0100000000001600140a7f5b65aa10e7b747bf3939b3615e633dae8908024730440220161e74f1a80f028078e425a7ed8545469f3c7cac1c590932d04d25e8b6236753022014e1a61030bd63a3c071704da508ab044562fb2e26c9d4ecbaa8d13fdbb900ce012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c319024730440220463bd34169d5a6c6527ac52495aa8760628ecc1a083a7d2a517a64a7813559b9022074ab2d958043bf8ea5fc92d8f8041d439949886bd320c0db41ed4e0664974bb5012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190247304402203501aef093a423171ec64befd78d58cca93538b167f391fe7e04e22cacf37e8c02203b99625b70b25f4f4a5b8e546b331bafb658d48d5e018077989dea281c11eb74012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190247304402202d0c84485669e928d07afdf5b9e4a5dacbef63884abe80f4cfcd29976919d617022022c950ae5bee89f1094955029432911ac5e30117fd1730ebf66992b8f3dda467012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c319024730440220732c55e39bcd7800db415ccefec605b7510887719346905344c64c3eca6621e002203d7294b9e0061bdac605cebbbb9e89a301f1cbcffcf2be339df5d64a0fbaf909012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c319024730440220409bd3f436c0cef89d4539a0ec64531580109252d877ff3f66bad90de22d2cee02204ab8f9e60d4ae76a24680174a77a7fa2ae1acb5edddfb5f84ac61213ed200bec012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31902473044022024e9a2c0554f10401270b7b540a18005f486f494c7428a399fd2bac4ceca570d02202d405a24f8787033dd9965b06980d998e88a599d9e334795e2fc19c377703558012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190247304402203619b621f5151b267b80ca6840b47ca13ac1a12a3a22cec02a950497c690ccb302205385c14c2f56701c999a72d7e72cacdae29a3da2b51869cd4e62cf95f23ece1e012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190247304402204f934c87bcaaec86ffcce62e2fde205162726d291f64d3603f3dddf8ffa639bc02203900c159805a02c02d69c8ec1ae6cdee4c0cbf4aedcea198e42793775faccec0012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31902473044022024a42e5d6381e6f831a8b7ff9ed580c4fcc9a9739752258629ad4ca3f7b1197c022011ae4c660f3839d84b4653634dbe290ae35850d4caa4814b461b0c83a8f19b48012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190247304402207cb6084b21ea12451ce766f50a4f01275cfe096e2993a2bbb3553dcea49fea0b02206749b91d8737dd7d69e69b709a9d2ec590dac34f19b06ce650042b16e1f0ece3012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c3190247304402200b2a37b3a116ff584eb9e3e1190901cf159029f10a3158cd372fd7e54e40e4ef022015d3323a864132200ead831b136e9c528300b2878275df8f94bc3988a3e2fb5f012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c319f0722100",
                height: 2192114,
                headerHex: "04000020af3f251c07aa4590c8227f60b355701aeef3df50235b25f786000000000000008d7e280383964c2689cdfea4a54cdfac931db86d2a8623ab0b9ab06e60410e8562864362d9ef001aa227f022"
            );
        }

        [Fact]
        public void Tx_4acbc3c017c338b4639c41b96d2176955e3d7bf77624b04994235db1b02f28b2()
        {
            RunTest(
                hex: "01000000000102064beec1dbbad1dfbce3497dc00aad0868db55fadbdb6f21b1a78e2967b285570100000000ffffffffad907bb22e3abd8a39b645647b829e39d588a055d6e908829fcfb1070319db370100000000ffffffff016a4d000000000000160014269a7224acf8a31f7be59efe7db8d9ba3a204ff60248304502210091f2e0e232b5833d7926f0a3dee09fd6b74891143bbb7614938785fb3d4c802e02204c54b358ad7b08ac765ea9c054e852a6ded9246084cd32d786bfd68f46b92e63012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31902473044022041eeab3442f838348153ea3714cff1ec6d7f148c75ef6d5b6e6693cf038e529302201f0e91a9ca54a1bbaf5bf598c4bd7014c7326d8cff464508e3b8c67b58650873012102e7ab2537b5d49e970309aae06e9e49f36ce1c9febbd44ec8e0d1cca0b4f9c31900000000",
                height: 2192260,
                headerHex: "0000002061551b56df0e50e94601634b14fb5b09c61a443677ad20ea5d0000000000000048e5fe5f14b690ce7a0cc1027299e561012e64712a414684e795bbb42bb85f0ccab64462ffff001d10efaeb7"
            );
        }

        void RunTest(string hex, int height, string headerHex)
        {
            var network = Network.TestNet;
            var account = wallet.CurrentAccount;
            var header = BlockHeader.Parse(headerHex, network);
            var tx = Tx.CreateFrom(hex, height, header, account);

            Assert.NotNull(tx);
            Assert.NotEqual(tx.Type, TxType.Partial);
        }

        static IWallet Load(string walletId, Network network, string passphrase = null, bool skipAuth = false)
        {
            var baseDirectory = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);
            var directory = Path.Combine(baseDirectory, "Regression", "Files", "Wallets");

            var storage = new FileSystemWalletStorage(walletId, network, directory);

            if (!storage.Exists())
            {
                Debug.WriteLine($"[Load] Wallet {walletId} doesn't exists. Make sure you're on the right network");

                throw new WalletException("Invalid wallet id");
            }

            return storage.Load(passphrase, out WalletException _, skipAuth);
        }
    }
}
